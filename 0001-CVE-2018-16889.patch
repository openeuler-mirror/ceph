--- a/src/rgw/rgw_rest_s3.cc	2018-08-31 01:24:39.000000000 +0800
+++ b/src/rgw/rgw_rest_s3.cc	2019-04-04 17:22:37.615000000 +0800
@@ -3751,8 +3751,9 @@ AWSGeneralAbstractor::get_auth_data_v4(c
   boost::optional<std::string> canonical_headers = \
     get_v4_canonical_headers(s->info, signed_hdrs, using_qs);
   if (canonical_headers) {
-    ldout(s->cct, 10) << "canonical headers format = " << *canonical_headers
-                      << dendl;
+  using sanitize = rgw::crypt_sanitize::log_content;
+  ldout(s->cct, 10) << "canonical headers format = "
+                    << sanitize{*canonical_headers} << dendl;
   } else {
     throw -EPERM;
   }
--- a/src/rgw/rgw_auth_s3.cc	2018-08-31 01:24:39.000000000 +0800
+++ b/src/rgw/rgw_auth_s3.cc	2019-04-04 17:25:27.208000000 +0800
@@ -659,7 +659,8 @@ get_v4_canon_req_hash(CephContext* cct,
 
   const auto canonical_req_hash = calc_hash_sha256(canonical_req);
 
-  ldout(cct, 10) << "canonical request = " << canonical_req << dendl;
+  using sanitize = rgw::crypt_sanitize::log_content;
+  ldout(cct, 10) << "canonical request = " << sanitize{canonical_req} << dendl;
   ldout(cct, 10) << "canonical request hash = "
                  << buf_to_hex(canonical_req_hash).data() << dendl;
 
